# Medication Photo OCR Decommission – October 31, 2025

## Summary
- Removed medication intent handling from `POST /api/upload/photo`; the backend now returns HTTP 410 with guidance to add medications manually or via forwarded prescription emails.
- Deleted the Vision-backed `extractMedicationDraft` service and associated tests, ensuring the photo pipeline focuses solely on bill statements.
- Simplified the shared `UploadPhotoResponse` type and mobile upload client to remove `medicationDraft`.
- Updated the mobile Plan screen to drop the “Scan prescription” CTA, promote manual entry, and reinforce email-based intake.
- Adjusted documentation (`docs/DETAILS.md`, `docs/medications.md`) to reflect the bill-only camera flow.

## Testing
- `npm run test:backend -- --run src/controllers/api/upload.vitest.test.ts`
- `npm run test:contracts -- --run src/plan.contract.vitest.test.ts`
- `npm run test --workspace=mobile -- --run src/api/__tests__/uploadsApi.vitest.test.ts`

## Medication Occurrence Date Fix

- Normalized daily occurrence seeding to respect each dose’s timezone, preventing morning doses from landing on the previous UTC day.
- Added `backend/scripts/backfill-medication-occurrence-dates.ts` to realign existing intakes and adjust pending `scheduled_for` timestamps.
- Hardened mobile summary/detail views to group occurrences by scheduled local day, with regression coverage for timezone boundary cases.

### Testing
- `npm run test:backend -- --run src/services/__tests__/medicationService.vitest.test.ts`
- `npm run test:backend`
- `npm run test:contracts`
- `npm run test --workspace=mobile`
